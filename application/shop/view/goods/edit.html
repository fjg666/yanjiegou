{extend name="Public:common" /}{block name="css"}<style>    .edui-editor{z-index: 1!important;}    .thumbs{width:90px;height:90px;margin: 5px;}    .thu_fill{font-size: 20px; color: #ABB1BA;opacity=0.3;margin-left:-30px; position: absolute;margin-top: 5px}    .layui-form-mid{float:none;}    .layui-input{display: inline-block;};    .layui-form-label{color:#1E9FFF}    .layui-upload-img { width: 90px; height: 90px; margin: 0; }    .pic-more { width:100%; left; margin: 10px 0px 0px 0px;}    .pic-more li { width:90px; float: left; margin-right: 5px;}    .pic-more li .layui-input { display: initial; }    .pic-more li a { position: absolute; top: 0; display: block; }    .pic-more li a i { font-size: 24px; background-color: #008800; }    #slide-pc-priview .item_img img{ width: 90px; height: 90px;}    #slide-pc-priview li{position: relative;}    #slide-pc-priview li .operate{ color: #000; display: none;}    #slide-pc-priview li .toleft{ position: absolute;top: 40px; left: 1px; cursor:pointer;}    #slide-pc-priview li .toright{ position: absolute;top: 40px; right: 1px;cursor:pointer;}    #slide-pc-priview li .close{position: absolute;top: 5px; right: 5px;cursor:pointer;}    #slide-pc-priview li:hover .operate{ display: block;}</style>{/block}{block name="content"}<div class="layui-fluid"><div class="layui-row layui-col-space15"><div class="layui-col-md12">    <fieldset class="layui-elem-field layui-field-title">        <legend>编辑商品</legend>    </fieldset>    <form class="layui-form" method="post">        <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">            <ul class="layui-tab-title">                <li class="layui-this">基本</li>                <li>图片</li>                <li>邮费设置</li>                <li>库存/规格</li>                <li>参数</li>                <li>详情</li>                <li>购买权限</li>              <!--   <li>营销</li>                <li>会员折扣</li> -->            </ul>            <style>               .layui-form-label{color:#1E9FFF}               .layui-input-inline{height: 38px;line-height: 38px;border:solid 1px #D2D2D2;padding-left: 10px}               table tr td:first-child{color:#009688;text-align: right;font-weight: bold; }            </style>            <div class="layui-tab-content" style="height: 100px;">                <!--商品添加-基本开始-->                <input type="hidden" name="id" value="{$info.id}">                <div class="layui-tab-item layui-show">                    <table class="layui-table">                        <tr>                          <td>排序</td>                          <td><input type="text" value="{$info.sorts}" name="sorts" placeholder="" autocomplete="off"  class="layui-input"></td>                          <td><div class="layui-form-mid layui-word-aux">数字越大，排名越靠前，如果为空，默认排序为创建时间</div></td>                        </tr>                        <tr>                          <td>商品名称</td>                          <td><input type="text" value="{$info.title}" name="title"   lay-verify="required" placeholder=""  autocomplete="off" class="layui-input"></td>                          <td><div class="layui-form-mid layui-word-aux">商品名称必须填写</div></td>                        </tr>                        <tr>                          <td>副标题</td>                          <td><input type="text" value="{$info.subheading}" name="subheading"   lay-verify="required" placeholder="" autocomplete="off" class="layui-input"></td>                          <td><div class="layui-form-mid layui-word-aux">副标题的长度尽量控制在100字以内</div></td>                        </tr>                        <tr>                            <td>关键字</td>                            <td>                                <input type="text" value="{$info.keywords}" name="keywords"  placeholder="" autocomplete="off" class="layui-input">                            </td>                            <td><div class="layui-form-mid layui-word-aux">商品关键字，能准确搜索到的商品，比如:海尔电视|电视之类</div></td>                        </tr>                        <tr>                            <td>商品类型</td>                            <td>                                <input type="radio" name="type" value="1" title="实体商品" {if ($info['type'] eq 1)}checked='checked'{/if}>                                <input type="radio" name="type" value="2" title="虚拟商品" {if ($info['type'] eq 2)}checked='checked'{/if}>                            </td>                            <td><div class="layui-form-mid layui-word-aux">商品类型，商品保存后无法修改，请谨慎选择</div></td>                        </tr>                                                <tr>                            <td>商品分类</td>                            <td><select  id="catid" lay-filter="catid" lay-verify="required" name="catid"  validate=" minlength:1, maxlength:6, required:true"  title="必须选择一个商品类型">                                    <option value="">请选择商品类型</option>                                    {$cat_tree}                                </select>                            </td>                        </tr>                        <tr>                            <td>品牌</td>                            <td><select  id="brandid"  name="brandid"  >                                    <option value="0">请选择品牌</option>                                    {volist name="brand" id="val"}                                    <option value="{$val.id}" {if ($info['brandid'] eq $val['id'])}selected='selected'{/if}>{$val.title}</option>                                    {/volist}                                </select>                            </td>                        </tr>                        <tr>                            <td>商品属性</td>                            <td>                                <input type="checkbox" name="isrecommand" lay-skin="primary" value="1" title="推荐" {if ($info['isrecommand'] eq 1)}checked='checked'{/if}>                                <input type="checkbox" name="isnew" lay-skin="primary" value="1" title="新品" {if ($info['isnew'] eq 1)}checked='checked'{/if}>                                <input type="checkbox" name="ishot" lay-skin="primary" value="1" title="热卖" {if ($info['ishot'] eq 1)}checked='checked'{/if}>                                <input type="checkbox" name="isdiscount" lay-skin="primary" value="1" title="促销" {if ($info['isdiscount'] eq 1)}checked='checked'{/if}>                            </td>                            <td></td>                        </tr>                        <tr>                            <td>价格</td>                            <td>                                商品价格                                <input type="text" value="{$info.price}" name="price"  autocomplete="off" class="layui-input-inline" lay-verify="required">元&nbsp;&nbsp;&nbsp;&nbsp;                                原价                                <input type="text" value="{$info.original_price}" name="original_price"  autocomplete="off" class="layui-input-inline">元&nbsp;&nbsp;&nbsp;&nbsp;                                成本价                                <input type="text" value="{$info.cost_price}" name="cost_price"  autocomplete="off" class="layui-input-inline">元                            </td>                             <td></td>                        </tr>                        <tr>                            <td>商品属性</td>                            <td>                                <input type="checkbox" name="iszk" lay-skin="primary" value="1" {if ($info['iszk'] eq 1)}checked='checked'{/if} title="折扣">&nbsp;&nbsp;&nbsp;&nbsp;                                折扣                                <input type="text" name="zk_price" value="{$info.zk_price}"  autocomplete="off" class="layui-input-inline">折                            </td>                            <td></td>                        </tr>                        <tr>                            <td>已出售数</td>                            <td>                                <input type="text" value="{$info.sold}" name="sold"  placeholder="" autocomplete="off" class="layui-input">                            </td>                            <td></td>                        </tr>                                                <tr>                            <td>标签</td>                            <td>                                {volist name="label" id="val"}                                 <input type="checkbox" value="{$val.title}" name="label[]" {if(in_array($val['title'],$info['label']))}checked{/if} lay-skin="primary" title="{$val.title}">                                {/volist}                            </td>                            <td></td>                        </tr>                        <tr>                            <td>上架</td>                            <td>                                <input type="radio" name="status" value="0" title="否" {if ($info['status'] eq 0)}checked='checked'{/if}>                                <input type="radio" name="status" value="1" title="上架" {if ($info['status'] eq 1)}checked='checked'{/if}>                            </td>                            <td></td>                        </tr>                    </table>                 </div>                <!--商品添加-基本结束-->                <div class="layui-tab-item">                    <div class="layui-form-item" id="pics">                        <div class="layui-form-label">相册图集</div>                        <div class="layui-input-block" style="width: 70%;">                            <div class="layui-upload">                                <button type="button" class="layui-btn layui-btn-primary pull-left" id="slide-pc">选择多图</button>                                <div class="pic-more">                                    <ul class="pic-more-upload-list" id="slide-pc-priview">                                        {foreach name="$info['headimg']" item="vo" key="k"}                                        <li class="item_img">                                            <div class="operate"><i class="toleft layui-icon"></i><i class="toright layui-icon"></i><i  class="close layui-icon"></i></div>                                            <img src="{$vo}" class="img" >                                            <input type="hidden" name="headimg[]" value="{$vo}" />                                        </li>                                        {/foreach}                                    </ul>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="layui-tab-item">                    <table class="layui-table">                        <tr>                        <td>包邮</td>                        <td>                            <input type="radio" name="issendfree" value="0" title="不包邮" {if ($info['issendfree'] eq 0)}checked='checked'{/if}>                            <input type="radio" name="issendfree" value="1" title="包邮" {if ($info['issendfree'] eq 1)}checked='checked'{/if}>                        </td>                        <td>如果选择包邮则下面“单品满件包邮、单品满额包邮、运费设置”设置为无效。</td>                    </tr>                        <tr>                            <td>单品满件包邮</td>                            <td>                                <input type="text" value="{$info.ednum}" name="ednum"  lay-verify="" placeholder="" autocomplete="off" class="layui-input">                            </td>                            <td><div class="layui-form-mid layui-word-aux">如果设置为0或空，则不支持满件包邮</div></td>                        </tr>                        <tr>                            <td>单品满额包邮</td>                            <td>                                <input type="text" value="{$info.edmoney}" name="edmoney" lay-verify="" placeholder="" autocomplete="off" class="layui-input">                            </td>                            <td><div class="layui-form-mid layui-word-aux">如果设置为0或空，则不支持满额包邮</div></td>                        </tr>                        <tr>                            <td class="layui-form-td">运费设置</td>                            <td>                                <input type="text" value="{$info.dispatchprice}" name="dispatchprice"  lay-verify="" placeholder="" autocomplete="off" class="layui-input-inline"> 元                            </td>                            <td></td>                        </tr>                    </table>                    </div>      <script type="text/javascript">// 商品分类点击查找对应的规格                // 市场价 本店价 库存 预警库存        function liefun(obj){            var val =  $(obj).val();            var i = $(obj).parents('th').index();            var table = $(obj).parents('table');            table.find('tbody tr').each(function(){                $(this).find('td').eq(i).find('input').val(val);            })        }        // 重新组合        function groupfun(obj){            // 把值给复选框            if(obj!=''){                var parent = $(obj).parents('tr');                var values = parent.find('.checkbox-val').val();                parent.find('.spec-checkbox').val(values);            }                                    var str = '';            var count = 1;            var spec = is_spec();            for (x in spec){                str += '<th><font color="red">*</font>'+spec[x].name+'</th>';                // res += '<td><input type="text" name="" class="layui-input"></td>';                count = spec[x].son.length*count;            }            // 表头            var heads = '<tr><th><font color="red">*</font>推荐规格</th>'+str+'<th><font color="red">*</font>货号</th>'+                        '<th><font color="red">*</font>市场价<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th><font color="red">*</font>本店价<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th><font color="red">*</font>库存<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th>销量</th></tr>';            $('#spec-sale-hed').html(heads);            // 所有组合html            var text = '';            if (!$.isEmptyObject(spec)) {                // 所有组合                const textArr=[];                var spec_input_val = [];                for (x in spec){                    textArr.push(spec[x].son);                    spec_input_val.push(x);                }                results = [];                result = [];                doExchange(textArr, 0);                // results 组合数组[['a','b'],['1','2']]                for (k in results) {                    var res = '';                    for (g in results[k]){                        res += '<td><input type="text" name="" class="layui-input" value="'+results[k][g]+'" readonly="readonly"></td>';                    }                    var is_have = results[k].join('!%');                    var sku_market_price='',sku_price='',sku_stock='';                    console.log(skugroup);                    console.log(is_have);                    if (skugroup != {}) {                        for (x in skugroup){                            if (skugroup[x].group == is_have) {                                sku_market_price = skugroup[x].market_price;                                sku_price = skugroup[x].money;                                sku_stock = skugroup[x].number;                                break;                            }                        }                    }                                        text += '<tr>'+                                '<td><input type="radio" name="ist_spec" value="'+k+'"><input type="hidden" name="results[]" value="'+results[k].join('!%')+'"></td>'+res+                                '<td><input type="text" name="sku_code[]" class="layui-input" value="'+k+'" readonly="readonly"></td>'+                                '<td><input type="text" name="sku_market_price[]" value="'+sku_market_price+'" class="layui-input"></td>'+                                '<td><input type="text" name="sku_price[]" value="'+sku_price+'" class="layui-input"></td>'+                                '<td><input type="text" name="sku_stock[]" value="'+sku_stock+'" class="layui-input"></td>'+                                '<td></td>'+                            '</tr>';                }            }                    $('#spec-sale-tby').html(text);            // 页面重新渲染            layui.use('form', function() {                var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功                form.render('radio');            });        }        /*方法*/        /*选择*/        function is_spec(){            var arr = {};            $('.spec-class').each(function(){                var id = $(this).attr('spec-class-id');                var name = $(this).attr('spec-class-name');                var son = [];                $(this).find('table tbody tr').each(function(){                    var is_true = $(this).find('.spec-checkbox').is(':checked');                    // console.log(is_h);                    var spec_code_id = $(this).find('.layui-input').attr('spec-code-id');                    var is_val = $(this).find('.layui-input').val();                    if (is_true && is_val != '') {                        son.push(is_val);                    }                })                if (son.length != 0) {                    arr[id] = {'name':name,'son':son};                }            });            // console.log(arr);            return arr;        };        // -- 递归查询        results = [];        result = [];        function doExchange(arr, index){                        for (var i = 0; i<arr[index].length; i++) {                result[index] = arr[index][i];                if (index != arr.length - 1) {                    doExchange(arr, index + 1)                } else {                    var resu = [];                    for ( f in result){                        resu.push(result[f]);                    }                    results.push(resu);                                    }            }        }        var skugroup = {};// 规格增加删除；=----------------------------    $(function(){        $.post("{:url('getSkuList')}",{goodsid:{$info.id}},function(e){            skugroup = e.data;        });        /*增加*/        var i = {$spec_count};        $('.goods-spec').on('click','.spec-add',function(){            i++;            var parent = $(this).parent('.spec-class');            var tbody = parent.find('table').find('tbody');            var spec_class_id = parent.attr('spec-class-id');            var code = spec_class_id+'_'+i;            var sign = 'spec'+code;            var text = '<tr spec-code-id="'+code+'"><td>'                            +'<input type="checkbox" lay-skin="primary" lay-filter="checkboxls" class="spec-checkbox" name="spec['+spec_class_id+'][]" value="">'                            +'</td>'                            +'<td><input type="text" name="" class="layui-input '+sign+' checkbox-val" spec-code-id="'+code+'" onchange="groupfun(this)"></td>'                            +'<td><input class="layui-btn layui-btn-sm layui-btn-normal spec-del" type="button"  value="删除" name=""></td>'                            +'</tr>'            tbody.append(text);            layui.use('form', function() {                var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功                form.render('checkbox');            });        })        /*删除*/        $('.goods-spec').on('click','.spec-del',function(){            $(this).parents('tr').remove();            groupfun(this);        })/*销售规格*/    })</script>                 <!--商品添加-库存/规格开始-->                <div class="layui-tab-item">                    <table class="layui-table">                        <tr>                           <td>编码</td>                           <td><input type="text" value="{$info.goodssn}" name="goodssn"  lay-verify="" autocomplete="off" class="layui-input"></td>                           <td></td>                        </tr>                        <tr>                           <td>条码</td>                           <td><input type="text" value="{$info.productsn}" name="productsn" lay-verify="" autocomplete="off" class="layui-input"></td>                           <td></td>                        </tr>                        <tr>                           <td>库存</td>                           <td>                                <input type="text" value="{$info.total}" name="total" lay-verify="" autocomplete="off" class="layui-input-inline">                                <input type="checkbox" name="showtotal" lay-skin="primary" title="显示库存" value="1" {if ($info['showtotal'] eq 1)}checked='checked'{/if}>                           </td>                           <td><div class="layui-form-mid layui-word-aux">商品剩余数量，如启用多规格或虚拟卡密则无效</div></td>                        </tr>                        <tr>                           <td></td>                           <td>                            <input type="radio" name="totalcnf" value="0" title="拍下减库存" {if ($info['totalcnf'] eq 0)}checked='checked'{/if}>                            <input type="radio" name="totalcnf" value="1" title="付款减库存" {if ($info['totalcnf'] eq 1)}checked='checked'{/if}>                            <input type="radio" name="totalcnf" value="2" title="永不减库存" {if ($info['totalcnf'] eq 2)}checked='checked'{/if}>                            </td>                           <td></td>                        </tr>                                            </table>                      <div class="goods-spec">                        <div><h3>商品规格</h3></div>                        <div id="spec-list">                            {volist name="spec" id="s"}                            <!-- 一类 -->                            <div class="spec-class" spec-class-id="{$s.id}" spec-class-name="{$s.name}">                                <h3 class="layui-form-label">{$s.name}</h3>                                <input class="layui-btn layui-btn-normal spec-add" type="button" value="新增" name="">                                <table class="layui-table">                                    <tbody>                                        {volist name="s.son" id="son"}                                        <tr spec-code-id="'+code+'">                                            <td>                                                <input type="checkbox" checked="checked" lay-skin="primary" lay-filter="checkboxls"  class="spec-checkbox" name="spec[{$s.id}][]" value="{$son.sttr_value}">                                            </td>                                            <td>                                                <input type="text" name="" class="layui-input '+sign+' checkbox-val" spec-code-id="'+code+'" value="{$son.sttr_value}" onchange="groupfun(this)" >                                            </td>                                            <td>                                                <input class="layui-btn layui-btn-sm layui-btn-normal spec-del" type="button"  value="删除" name="">                                            </td>                                        </tr>                                        {/volist}                                                                            </tbody>                                </table>                            </div>                            {/volist}                                                    </div>                        <p style="color: red; background: yellow;padding: 2px 10px;">1.若改动商品规格时，销售规则表将会重新绘制，填写销售规格表前选择好商品规格</p>                        <div><h3>销售规格</h3></div>                        <div class="sales-spec">                            <table class="layui-table">                                <thead id="spec-sale-hed">                                    <tr>                                        <th><font color="red">*</font>推荐规格</th>                                        {volist name="theads" id="t"}                                        <th><font color="red">*</font>{$t}</th>                                        {/volist}                                        <th><font color="red">*</font>货号</th>                                        <th><font color="red">*</font>市场价<br>                                            <input type="text" class="layui-input">                                        </th>                                        <th><font color="red">*</font>本店价<br>                                            <input type="text" class="layui-input">                                        </th>                                        <th><font color="red">*</font>库存<br>                                            <input type="text" class="layui-input">                                        </th>                                                                                     <th>销量</th>                                    </tr>                                 </thead>                                  <tbody id="spec-sale-tby">                                    {volist name="sku" id="u"}                                    <tr>                                        <td>                                            <input type="radio" {if condition="$u['is_default'] eq 1"}checked{/if} name="ist_spec" value="{$key}">                                            <input type="hidden" name="results[]" value="{$u.group}">                                        </td>                                        {volist name="u.son" id="un"}                                        <td><input type="text" name="" class="layui-input" value="{$un.value}" readonly="readonly"></td>                                        {/volist}                                        <td><input type="text" name="sku_code[]" class="layui-input" value="{$u.code_sku}" readonly="readonly"></td>                                        <td><input type="text" name="sku_market_price[]" value="{$u.market_price}" class="layui-input"></td>                                        <td><input type="text" name="sku_price[]" value="{$u.money}" class="layui-input"></td>                                        <td><input type="text" name="sku_stock[]" value="{$u.number}" class="layui-input"></td>                                        <td>{$u.volume}</td>                                    </tr>                                    {/volist}                                    <!-- <tr>                                        <td><input type="radio" name="ist_spec"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td></td>                                    </tr>                                    <tr>                                        <td><input type="radio" name="ist_spec"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td><input type="text" name="" class="layui-input"></td>                                        <td></td>                                    </tr> -->                                </tbody>                            </table>                        </div>                    </div>                                        </div>                <!--商品添加-库存/规格结束-->                <!--参数开始-->                <div class="layui-tab-item">                    <table class="layui-table">                        {foreach name="$info['parameter']" item="vo" key="k"}                        <tr>                            <td>参数名-值</td>                            <td>                            <input type="text" value="{$k}" name="parameter[]" lay-verify="" autocomplete="off" class="layui-input-inline"> -                            <input type="text" value="{$vo}" name="parameter_value[]" lay-verify="" autocomplete="off" class="layui-input-inline">&nbsp;&nbsp;&nbsp;<button class="layui-btn layui-btn-sm layui-btn-normal" id="deltr"><i class="layui-icon"></i> 删除</button></td>                        </tr>                        {/foreach}                        <tr>                            <td colspan="2" style="text-align: center"><span id="addtr" style="cursor:pointer;font-size:30px;">+</span></td>                        </tr>                    </table>                </div>                <!--参数结束-->                <!--详情开始-->                <div class="layui-tab-item">                     <div class="layui-form-item" style="height: 600px;">                        <script src="LIB/ueditor/ueditor.config.js">/*引入配置文件*/</script>                        <script src="LIB/ueditor/ueditor.all.js">/*引入源码文件*/</script>                        <textarea id="content" name="content" style="border:1px solid #E5E5E5;height:500px">{$info.content}</textarea>                            <script type="text/javascript">                            UE.getEditor("content");//实例化编辑器  传参,id为将要被替换的容器。                        </script>                    </div>                </div>                <!--详情结束-->                <!--购买权限开始-->                <div class="layui-tab-item">                    <table class="layui-table">                    <tr>                        <td>单次最多购买</td>                        <td>                            <input type="text" value="{$info.maxbuy}" name="maxbuy" lay-verify="pass" placeholder="" autocomplete="off" class="layui-input-inline"> 件                        </td>                        <td><div class="layui-form-mid layui-word-aux"> 用户单次购买商品数量限制</div></td>                    </tr>                    <tr>                        <td>单次最低购买</td>                        <td>                            <input type="text" value="{$info.minbuy}" name="minbuy" lay-verify="" placeholder="" autocomplete="off" class="layui-input-inline"> 件                        </td>                        <td><div class="layui-form-mid layui-word-aux"> 用户单次最少购买数量限制</div></td>                    </tr>                    <tr>                        <td>最多购买</td>                        <td>                            <input type="text" value="{$info.usermaxbuy}" name="usermaxbuy" lay-verify="" placeholder="" autocomplete="off" class="layui-input-inline"> 件                                                    </td>                        <td><div class="layui-form-mid layui-word-aux"> 用户购买过此商品数量限制</div></td>                    </tr>                                       </table>                </div>                <!--购买权限结束-->                <!--营销开始-->                <!-- <div class="layui-tab-item">                    <table class="layui-table">                        <tr>                            <td>积分赠送</td>                            <td><input type="text" value="{$info.credit}" name="credit" lay-verify="" placeholder="" autocomplete="off" class="layui-input-inline"> 分</td>                            <td><div class="layui-form-mid layui-word-aux">会员购物赠送的积分，如果不填写或填写0，则默认为不赠送积分，如果带%则按成交价的比例计算积分</div>                            <div class="layui-form-mid layui-word-aux">如:购买2件，设置10元，不管成交价格多少，则购买后获得20积分</div>                            <div class="layui-form-mid layui-word-aux">如:购买2件，设置10%积分，成交价格2*200=400，则购买后获得40积分(400*10%)</div></td>                        </tr>                        <tr>                            <td>余额返现</td>                            <td><input type="text" value="{$info.money}" name="money" lay-verify="pass" placeholder="" autocomplete="off" class="layui-input-inline"> 元</td>                            <td><div class="layui-form-mid layui-word-aux">会员购物返现，如果不填写或填写0，则默认为不返现，如果带%则按成交价的比例计算返现</div>                            <div class="layui-form-mid layui-word-aux">如:购买2件，设置10元，不管成交价格多少，则购买后获得20元</div>                            <div class="layui-form-mid layui-word-aux">如:购买2件，设置10%元，成交价格2*200=400，则购买后获得40元返现(400*10%)</div></td>                        </tr>                        <tr>                            <td>重复购买折扣</td>                            <td><input type="text" value="{$info.buyagain}" name="buyagain" lay-verify="pass" placeholder="" autocomplete="off" class="layui-input-inline"> 折</td>                            <td><div class="layui-form-mid layui-word-aux">重复购买此商品，享受的折扣</div></td>                        </tr>                         <tr>                            <td>持续使用</td>                            <td><input type="radio" name="buyagain_islong" value="1" title="是" {if ($info['buyagain_islong'] eq 1)}checked='checked'{/if}>                            <input type="radio" name="buyagain_islong" value="0" title="否" {if ($info['buyagain_islong'] eq 0)}checked='checked'{/if}></td>                            <td><div class="layui-form-mid layui-word-aux">购买一次后，以后都使用此折扣</div></td>                        </tr>                         <tr>                            <td>使用条件</td>                            <td><input type="radio" name="buyagain_condition" value="0" title="订单付款后" {if ($info['buyagain_condition'] eq 0)}checked='checked'{/if}>                            <input type="radio" name="buyagain_condition" value="1" title="订单完成后" {if ($info['buyagain_condition'] eq 1)}checked='checked'{/if}></td>                            <td><div class="layui-form-mid layui-word-aux">重复购买使用条件，是付款后还是完成后，默认是付款后</div></td>                        </tr>                         <tr>                            <td>可以使用优惠</td>                            <td><input type="radio" name="buyagain_sale" value="1" title="是" {if ($info['buyagain_sale'] eq 1)}checked='checked'{/if}>                            <input type="radio" name="buyagain_sale" value="0" title="否" {if ($info['buyagain_sale'] eq 0)}checked='checked'{/if}></td>                            <td><div class="layui-form-mid layui-word-aux">重复购买时，是否与其他优惠共享！其他优惠享受后，在使用这个折扣(其他优惠不包含优惠券)</div></td>                        </tr>                    </table>                </div> -->                <!--营销结束-->                <!--会员折扣开始-->                <!-- <div class="layui-tab-item">                  <table class="layui-table">                     <tr>                        <td>不参与会员折扣</td>                        <td>                            <input type="radio" name="notiscount" value="0" title="不参与" {if ($info['notiscount'] eq 0)}checked='checked'{/if}>                            <input type="radio" name="notiscount" value="1" title="参与" {if ($info['notiscount'] eq 1)}checked='checked'{/if}>                        </td>                        <td></td>                    </tr>                    <tr>                        <td>会员折扣</td>                        <td><input type="text" value="{$info.hui_discount}" name="hui_discount" lay-verify="" autocomplete="off" class="layui-input-inline"> 折</td>                        <td></td>                    </tr>                    <tr>                        <td>或者会员价</td>                        <td><input type="text" value="{$info.hui_price}" name="hui_price" lay-verify="" autocomplete="off" class="layui-input-inline"> 元</td>                        <td></td>                    </tr>                    <tr><td>说明</td><td colspan="2">                        <h3>统一设置折扣0.1—10之间</h3>                        <div class="layui-form-mid layui-word-aux">只有当折扣大于0，小于10才能生效，否则按自身会员等级折扣计算</div>                        <div class="layui-form-mid layui-word-aux">如果折扣为空或者为0，则不设置折扣，折扣和固定金额都有，则优先使用折扣</div>                        <div class="layui-form-mid layui-word-aux">如果会员价为空或者0，则不设置会员价</div>                      </td></tr>                  </table>                  </div> -->                <!--会员折扣结束-->                <div style="text-align: center;margin: 10px;">                    <button type="button" class="layui-btn" lay-submit="" lay-filter="submit">提交</button>                    <a href="{:url('index')}" class="layui-btn layui-btn-primary">返回列表</a>                </div>            </div>        </div>          </form></div></div></div>    {/block}{block name="js"}  <script>var identity = 'ruler';var moduleid = '{$moduleid}';var attachmark = '{$attachmark}';var uploadApi = "{:url('upload/index/uploadimage')}";    layui.use(['form','upload','layedit','laydate','jquery','element'], function () {        var form = layui.form,upload = layui.upload,layedit = layui.layedit,laydate = layui.laydate,$ = layui.jquery;element = layui.element;        //多图片上传        upload.render({            elem: '#slide-pc',             url: uploadApi,            data: {                moduleid: moduleid,                attachmark: attachmark,                identity: identity,            },            field: 'upfile',            //size: 100000000000,            exts: 'jpg|png|jpeg|gif',            multiple: true,            before: function(obj) {                layer.msg('图片上传中...', {                    icon: 16,                    shade: 0.01,                    time: 0                })            },            done: function(res) {                layer.close(layer.msg());//关闭上传提示窗口                if(res.status == 'success') {                    $('#slide-pc-priview').append('<li class="item_img"><div class="operate"><i class="toleft layui-icon"></i><i class="toright layui-icon"></i><i  class="close layui-icon"></i></div><img src="' + res.uploadInfo.attachurl + '" class="img" ><input type="hidden" name="headimg[]" value="' + res.uploadInfo.attachurl + '" /></li>');                }else{                    return layer.msg(res.message);                }                            }        });        //点击多图上传的X,删除当前的图片        $("body").on("click",".close",function(){            $(this).closest("li").remove();        });        //多图上传点击<>左右移动图片        $("body").on("click",".pic-more ul li .toleft",function(){            var li_index=$(this).closest("li").index();            if(li_index>=1){                $(this).closest("li").insertBefore($(this).closest("ul").find("li").eq(Number(li_index)-1));            }        });        $("body").on("click",".pic-more ul li .toright",function(){            var li_index=$(this).closest("li").index();            $(this).closest("li").insertAfter($(this).closest("ul").find("li").eq(Number(li_index)+1));        });        form.on('submit(submit)', function (data) {            console.log(data);            // return false;            $.post('{:url()}', data.field, function (res) {                if (res.code > 0) {                    layer.msg(res.msg, {time: 1800, icon: 1}, function () {                        //location.href = res.url;                        window.location.href="{:url('index')}"                    });                } else {                    layer.msg(res.msg, {time: 1800, icon: 2});                }            });        });                form.on('select(catid)',function(data){            $.post("{:url('getcatidtype')}",{id:data.value},function(e){                var data = e.data;                var html = '';                for (x in data) {                    html += '<div class="spec-class" spec-class-id="'+data[x].id+'" spec-class-name="'+data[x].key+'">'                            +'<h3 class="layui-form-label">'+data[x].key+'</h3>'                            +'<input class="layui-btn layui-btn-normal spec-add" type="button" value="新增" name="">'                            +'<table class="layui-table">'                            +'<tbody>'                            +'</tbody>'                            +'</table>'                            +'</div>';                }                $('#spec-list').html(html);                var heads = '<tr><th><font color="red">*</font>推荐规格</th><th><font color="red">*</font>货号</th>'+                        '<th><font color="red">*</font>市场价<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th><font color="red">*</font>本店价<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th><font color="red">*</font>库存<br><input type="text" class="layui-input" onchange="liefun(this)"></th>'+                        '<th>销量</th></tr>';                $('#spec-sale-hed').html(heads);                $('#spec-sale-tby').html('');            });        })        form.on('checkbox(checkboxls)',function(obj){            var data = $(obj.elem);            groupfun(data);        })        $('.layui-form').on('click','#addtr',function(){             $(this).parent().parent().before('<tr><td>参数名-值</td><td><input type="text" name="parameter[]" lay-verify="" autocomplete="off" class="layui-input-inline"> - <input type="text" name="parameter_value[]" lay-verify="" autocomplete="off" class="layui-input-inline">&nbsp;&nbsp;&nbsp;<button class="layui-btn layui-btn-sm layui-btn-normal" id="deltr"><i class="layui-icon"></i> 删除</button></td></tr>');        });        $('.layui-form').on('click','#deltr',function(){            $(this).parent().parent().remove();        });    });</script>{/block}